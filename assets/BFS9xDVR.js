import{_ as k,o as d,c,a as t,t as m,s as u,v as g,d as x,F as b,x as f,z as v,n as w,y as T,q as C}from"./CQuNkM7v.js";import{n as p}from"./CevjBdXS.js";import{M as y}from"./Ct04BUsa.js";import{v as B}from"./CQkTLCs1.js";const I={props:{title:String,target:String,item:Object,products:Array},data(){return{transactions:[],form:{customer:"",nota:"",total:"",reciver:"",items:[{item:"",amount:"",price:""}]}}},methods:{submitEmiting(){this.$emit("submitTransaction",this.form)},addItem(){this.form.items.push({item:"",amount:"",price:""}),console.log(this.form.items)},changeItem(r,e){let l=this.form.items[e].item;this.form.items[e].price=l.price},removeItem(r){this.form.items.splice(r,1),this.updateTotalPrice()},updateTotalPrice(){this.form.total=0,this.form.items.forEach(r=>{typeof r.amount=="number"&&(this.form.total+=r.price*r.amount)})}},mounted(){console.log("opened"),console.log(this.products),this.target!="create"&&(console.log(this.item),this.form.customer=this.item.customer,this.form.nota=this.item.nota,this.form.total=this.item.total,this.form.reciver=this.item.reciver,this.form.items=this.item.items)}},M={class:"relative bg-white rounded-lg shadow dark:bg-gray-700"},S={class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600"},E={class:"text-lg font-semibold text-gray-900 dark:text-white"},D=t("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),N=t("span",{class:"sr-only"},"Close modal",-1),V=[D,N],P={class:"grid gap-4 mb-4 grid-cols-2"},U={class:"col-span-2"},q=t("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Nama Customer",-1),F={class:"col-span-2"},j=t("label",{for:"nota",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"No Nota",-1),A={class:"col-span-2"},K={for:"nota",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},$={class:"flex mb-2"},z=["onChange","onUpdate:modelValue"],H=t("option",{value:"",disabled:""},"Pilih Barang",-1),J=["value"],R=["onUpdate:modelValue"],L=["onClick"],O={class:"col-span-2"},G=t("label",{for:"category",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Total Transaksi",-1),Q={class:"col-span-2"},W=t("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Penerima",-1),X=t("button",{type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},[t("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})]),x(" Submit ")],-1);function Y(r,e,l,_,o,n){return d(),c("div",M,[t("div",S,[t("h3",E,m(l.title)+" Transaksi Baru ",1),t("button",{onClick:e[0]||(e[0]=s=>r.$emit("closeModal")),type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal"},V)]),t("form",{onSubmit:e[7]||(e[7]=w((...s)=>n.submitEmiting&&n.submitEmiting(...s),["prevent"])),class:"p-4 md:p-5"},[t("div",P,[t("div",U,[q,u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.customer=s),type:"text",name:"customer",id:"customer",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Masukan Nama Produk",required:""},null,512),[[g,o.form.customer]])]),t("div",F,[j,u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.nota=s),type:"number",name:"nota",id:"nota",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Masukan Kode Produk",required:""},null,512),[[g,o.form.nota]])]),t("div",A,[t("label",K,[x("Barang "),t("button",{onClick:e[3]||(e[3]=(...s)=>n.addItem&&n.addItem(...s)),type:"button",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 px-2 py-1"},"+ Tambah ")]),(d(!0),c(b,null,f(o.form.items,(s,a)=>(d(),c("div",$,[u(t("select",{onChange:i=>n.changeItem(i,a),"onUpdate:modelValue":i=>o.form.items[a].item=i,type:"number",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Masukan Kode Produk",required:""},[H,(d(!0),c(b,null,f(l.products,(i,h)=>(d(),c("option",{value:i},m(i.name),9,J))),256))],40,z),[[v,o.form.items[a].item]]),u(t("input",{"onUpdate:modelValue":i=>o.form.items[a].amount=i,onInput:e[4]||(e[4]=(...i)=>n.updateTotalPrice&&n.updateTotalPrice(...i)),"item.amount":"",type:"number",class:"w-1/4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Jumlah",required:""},null,40,R),[[g,o.form.items[a].amount]]),t("button",{onClick:i=>n.removeItem(a),type:"button",class:"text-white inline-flex items-center bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800"}," Hapus ",8,L)]))),256))]),t("div",O,[G,u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.form.total=s),readonly:"",type:"number",name:"total",id:"total",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Masukan Kategroi Produk",required:""},null,512),[[g,o.form.total]])]),t("div",Q,[W,u(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.form.reciver=s),type:"text",name:"reciver",id:"reciver",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Scan/Masukan Nomor Barcode",required:""},null,512),[[g,o.form.reciver]])])]),X],32)])}const Z=k(I,[["render",Y]]),tt={data(){return{transactions:[],products:[],formTarget:"create",formTargetItem:{},formTitle:"Buat Transaksi Baru",formTargetId:"",renderComponent:!0}},methods:{async rerender(){this.renderComponent=!1,await this.$nextTick(),this.renderComponent=!0},fetchData(){let r=p.localStorage.getData("transactions");this.transactions=r;let e=p.localStorage.getData("products");this.products=e},async openFormAddTransaction(){console.log("add");const r=document.getElementById("crud-modal"),e=new y(r);this.formTarget="create",this.formTitle="Buat Transaksi Baru",await this.rerender(),e.show()},async openFormEditTransaction(r){console.log("edit");const e=document.getElementById("crud-modal"),l=new y(e);this.formTarget="update",this.formTitle="Edit Transaksi Baru",this.formTargetId=r.id,this.formTargetItem=r,await this.rerender(),l.show()},closeModal(){const r=document.getElementById("crud-modal");new y(r).hide()},formTransaksi(r){let e=p.localStorage.getData("transactions");e||(e=[]),this.formTarget=="create"?e.push({id:B(),...r}):e=this.updateData(this.formTargetId,r),p.localStorage.setData("transactions",e,9999,"d"),this.transactions=e},removeData(r){p.localStorage.setData("transactions",this.transactions.filter(e=>e.id!==r),9999,"d"),this.fetchData()},updateData(r,e){return this.transactions.map(l=>l.id===r?{...l,...e}:l)},searchById(r){return this.transactions.find(e=>e.id===r)}},mounted(){this.fetchData()}},et=t("button",{"data-modal-target":"crud-modal",style:{display:"hidden"}},null,-1),rt={id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},ot={class:"relative p-4 w-full max-w-xl max-h-full"},at={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},st={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},nt=t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[t("tr",null,[t("th",{scope:"col",class:"p-4"},[t("div",{class:"flex items-center"},[t("input",{id:"checkbox-all",type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),t("label",{for:"checkbox-all",class:"sr-only"},"checkbox")])]),t("th",{scope:"col",class:"px-6 py-3"}," Nomor Nota "),t("th",{scope:"col",class:"px-6 py-3"}," Nama Customer "),t("th",{scope:"col",class:"px-6 py-3"}," Nama Penerima "),t("th",{scope:"col",class:"px-6 py-3"}," Barang "),t("th",{scope:"col",class:"px-6 py-3"}," Total "),t("th",{scope:"col",class:"px-6 py-3"})])],-1),it={class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},lt=t("td",{class:"w-4 p-4"},[t("div",{class:"flex items-center"},[t("input",{id:"checkbox-table-1",type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),t("label",{for:"checkbox-table-1",class:"sr-only"},"checkbox")])],-1),dt={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},ct={class:"px-6 py-4"},mt={class:"px-6 py-4"},ut={class:"px-6 py-4"},gt={class:"px-6 py-4"},pt={class:"px-6 py-4"},ht=["href"],bt=["onClick"];function ft(r,e,l,_,o,n){const s=Z;return d(),c("div",null,[t("button",{onClick:e[0]||(e[0]=(...a)=>n.openFormAddTransaction&&n.openFormAddTransaction(...a)),class:"block text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 my-4",type:"button"}," Tambah Transaksi "),et,t("div",rt,[t("div",ot,[o.renderComponent?(d(),T(s,{key:0,title:o.formTitle,target:o.formTarget,item:o.formTargetItem,products:o.products,onSubmitTransaction:e[1]||(e[1]=a=>n.formTransaksi(a)),onCloseModal:n.closeModal},null,8,["title","target","item","products","onCloseModal"])):C("",!0)])]),t("div",at,[t("table",st,[nt,t("tbody",null,[(d(!0),c(b,null,f(o.transactions,(a,i)=>(d(),c("tr",it,[lt,t("td",dt,m(a.nota),1),t("td",ct,m(a.customer),1),t("td",mt,m(a.reciver),1),t("td",ut,[t("ul",null,[(d(!0),c(b,null,f(a.items,(h,yt)=>(d(),c("li",null,m(h.item.name)+" (Rp."+m(r.$commafy(h.price))+") ",1))),256))])]),t("td",gt," Rp."+m(r.$commafy(a.total)),1),t("td",pt,[t("a",{href:"/pdf/nota?id="+a.id,target:"_blank",class:"text-white py-2 px-3 bg-green-400 ms-4"}," Export Kwitansi ",8,ht),t("button",{type:"button",onClick:h=>r.exportSJ(a.id),class:"text-white py-2 px-3 bg-green-400 ms-4"}," Export Surat jalan ",8,bt)])]))),256))])])])])}const wt=k(tt,[["render",ft]]);export{wt as default};
