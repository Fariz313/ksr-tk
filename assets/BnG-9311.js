import{_,o as n,c as d,a as t,t as m,s as u,v as g,d as b,F as h,x as f,z as T,n as C,y as M,q as B,b as k,w as x}from"./CesgyUys.js";import{_ as I}from"./BFEprPvS.js";import{n as p}from"./CevjBdXS.js";import{M as S}from"./Ct04BUsa.js";import{v as E}from"./CQkTLCs1.js";const N={props:{title:String,target:String,item:Object,products:Array},data(){return{transactions:[],form:{customer:"",nota:"",total:"",reciver:"",items:[{item:"",amount:"",price:""}]}}},methods:{submitEmiting(){this.$emit("closeModal"),this.$emit("submitTransaction",this.form)},addItem(){this.form.items.push({item:"",amount:"",price:""}),console.log(this.form.items)},changeItem(r,e){let l=this.form.items[e].item;this.form.items[e].price=l.price},removeItem(r){this.form.items.splice(r,1),this.updateTotalPrice()},updateTotalPrice(){this.form.total=0,this.form.items.forEach(r=>{typeof r.amount=="number"&&(this.form.total+=r.price*r.amount)})}},mounted(){console.log("opened"),console.log(this.products),this.target!="create"&&(console.log(this.item),this.form.customer=this.item.customer,this.form.nota=this.item.nota,this.form.total=this.item.total,this.form.reciver=this.item.reciver,this.form.items=this.item.items)}},D={class:"relative bg-white rounded-lg shadow dark:bg-gray-700"},V={class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600"},P={class:"text-lg font-semibold text-gray-900 dark:text-white"},U=t("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),j=t("span",{class:"sr-only"},"Close modal",-1),q=[U,j],F={class:"grid gap-4 mb-4 grid-cols-2"},A={class:"col-span-2"},K=t("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Nama Customer",-1),z={class:"col-span-2"},H=t("label",{for:"nota",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"No Nota",-1),L={class:"col-span-2"},R={for:"nota",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},J={class:"flex mb-2"},O=["onChange","onUpdate:modelValue"],G=t("option",{value:"",disabled:""},"Pilih Barang",-1),Q=["value"],W=["onUpdate:modelValue"],X=["onClick"],Y={class:"col-span-2"},Z=t("label",{for:"category",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Total Transaksi",-1),$={class:"col-span-2"},tt=t("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Penerima",-1),et={type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},rt=t("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),ot={key:0},at={key:1};function st(r,e,l,v,a,i){return n(),d("div",D,[t("div",V,[t("h3",P,m(l.title)+" Transaksi Baru ",1),t("button",{onClick:e[0]||(e[0]=s=>r.$emit("closeModal")),type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-toggle":"crud-modal"},q)]),t("form",{onSubmit:e[7]||(e[7]=C((...s)=>i.submitEmiting&&i.submitEmiting(...s),["prevent"])),class:"p-4 md:p-5"},[t("div",F,[t("div",A,[K,u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.form.customer=s),type:"text",name:"customer",id:"customer",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Masukan Nama Produk",required:""},null,512),[[g,a.form.customer]])]),t("div",z,[H,u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.form.nota=s),type:"number",name:"nota",id:"nota",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Masukan Kode Produk",required:""},null,512),[[g,a.form.nota]])]),t("div",L,[t("label",R,[b("Barang "),t("button",{onClick:e[3]||(e[3]=(...s)=>i.addItem&&i.addItem(...s)),type:"button",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 px-2 py-1"},"+ Tambah ")]),(n(!0),d(h,null,f(a.form.items,(s,c)=>(n(),d("div",J,[u(t("select",{onChange:o=>i.changeItem(o,c),"onUpdate:modelValue":o=>a.form.items[c].item=o,type:"number",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Masukan Kode Produk",required:""},[G,(n(!0),d(h,null,f(l.products,(o,w)=>(n(),d("option",{value:o},m(o.name),9,Q))),256))],40,O),[[T,a.form.items[c].item]]),u(t("input",{"onUpdate:modelValue":o=>a.form.items[c].amount=o,onInput:e[4]||(e[4]=(...o)=>i.updateTotalPrice&&i.updateTotalPrice(...o)),"item.amount":"",type:"number",class:"w-1/4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Jumlah",required:""},null,40,W),[[g,a.form.items[c].amount]]),t("button",{onClick:o=>i.removeItem(c),type:"button",class:"text-white inline-flex items-center bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800"}," Hapus ",8,X)]))),256))]),t("div",Y,[Z,u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.form.total=s),readonly:"",type:"number",name:"total",id:"total",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Masukan Kategroi Produk",required:""},null,512),[[g,a.form.total]])]),t("div",$,[tt,u(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>a.form.reciver=s),type:"text",name:"reciver",id:"reciver",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Scan/Masukan Nomor Barcode",required:""},null,512),[[g,a.form.reciver]])])]),t("button",et,[rt,l.target=="create"?(n(),d("span",ot," Submit ")):(n(),d("span",at," Edit "))])],32)])}const it=_(N,[["render",st]]),nt={data(){return{transactions:[],products:[],formTarget:"create",formTargetItem:{},formTitle:"Buat Transaksi Baru",formTargetId:"",renderComponent:!0,targetEl:"",modal:""}},methods:{async rerender(){this.renderComponent=!1,await this.$nextTick(),this.renderComponent=!0},fetchData(){let r=p.localStorage.getData("transactions");this.transactions=r;let e=p.localStorage.getData("products");this.products=e},async openFormAddTransaction(){console.log("add"),this.formTarget="create",this.formTitle="Buat Transaksi Baru",await this.rerender(),this.modal.show()},async openFormEditTransaction(r){console.log("edit"),this.formTarget="update",this.formTitle="Edit Transaksi Baru",this.formTargetId=r.id,this.formTargetItem=r,await this.rerender(),this.modal.show()},closeModal(){this.modal.hide()},formTransaksi(r){let e=p.localStorage.getData("transactions");e||(e=[]),this.formTarget=="create"?e.push({id:E(),...r}):e=this.updateData(this.formTargetId,r),p.localStorage.setData("transactions",e,9999,"d"),this.transactions=e},removeData(r){p.localStorage.setData("transactions",this.transactions.filter(e=>e.id!==r),9999,"d"),this.fetchData()},updateData(r,e){return this.transactions.map(l=>l.id===r?{...l,...e}:l)},searchById(r){return this.transactions.find(e=>e.id===r)}},mounted(){this.targetEl=document.getElementById("crud-modal"),this.modal=new S(this.targetEl),this.fetchData()}},dt=t("button",{"data-modal-target":"crud-modal",style:{display:"hidden"}},null,-1),lt={id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},ct={class:"relative p-4 w-full max-w-xl max-h-full"},mt={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},ut={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},gt=t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3"}," Nomor Nota "),t("th",{scope:"col",class:"px-6 py-3"}," Nama Customer "),t("th",{scope:"col",class:"px-6 py-3"}," Nama Penerima "),t("th",{scope:"col",class:"px-6 py-3"}," Barang "),t("th",{scope:"col",class:"px-6 py-3"}," Total "),t("th",{scope:"col",class:"px-6 py-3"})])],-1),pt={class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},ht={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},ft={class:"px-6 py-4"},bt={class:"px-6 py-4"},yt={class:"px-6 py-4"},kt={class:"px-6 py-4"},xt={class:"px-6 py-4"};function _t(r,e,l,v,a,i){const s=it,c=I;return n(),d("div",null,[t("button",{onClick:e[0]||(e[0]=(...o)=>i.openFormAddTransaction&&i.openFormAddTransaction(...o)),class:"block text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 my-4",type:"button"}," Tambah Transaksi "),dt,t("div",lt,[t("div",ct,[a.renderComponent?(n(),M(s,{key:0,title:a.formTitle,target:a.formTarget,item:a.formTargetItem,products:a.products,onSubmitTransaction:e[1]||(e[1]=o=>i.formTransaksi(o)),onCloseModal:i.closeModal},null,8,["title","target","item","products","onCloseModal"])):B("",!0)])]),t("div",mt,[t("table",ut,[gt,t("tbody",null,[(n(!0),d(h,null,f(a.transactions,(o,w)=>(n(),d("tr",pt,[t("td",ht,m(o.nota),1),t("td",ft,m(o.customer),1),t("td",bt,m(o.reciver),1),t("td",yt,[t("ul",null,[(n(!0),d(h,null,f(o.items,(y,vt)=>(n(),d("li",null,m(y.item.name)+" (Rp."+m(r.$commafy(y.price))+") ",1))),256))])]),t("td",kt," Rp."+m(r.$commafy(o.total)),1),t("td",xt,[k(c,{to:"/pdf/nota?id="+o.id,target:"_blank",class:"text-white py-2 px-3 bg-green-400 ms-4"},{default:x(()=>[b(" Export Kwitansi ")]),_:2},1032,["to"]),k(c,{to:"/pdf/sj?id="+o.id,target:"_blank",class:"text-white py-2 px-3 bg-green-400 ms-4"},{default:x(()=>[b(" Export Surat jalan ")]),_:2},1032,["to"])])]))),256))])])])])}const It=_(nt,[["render",_t]]);export{It as default};
